<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>분리수거 도우미</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- 상단 헤더 -->
    <header>
      <div class="logo">
        <img src="image/home/logo.png" alt="분리수거 도우미 로고" id="Logo" />
      </div>
      <div class="header-buttons">
        <!--  로그인 클릭 시 login.html로 이동하도록 수정 -->
        <button
          id="loginBtn"
          class="login"
          onclick="location.href='login.html'"
        >
          로그인
        </button>
        <button
          id="mypageBtn"
          class="mypage"
          onclick="location.href='mypage.html'"
        >
          마이페이지
        </button>
        <!-- 로그아웃 버튼 추가(처음엔 숨김) -->
        <button id="logoutBtn" class="logout" style="display: none">
          로그아웃
        </button>
      </div>
    </header>

    <div class="container">
      <!-- 왼쪽 사이드바 -->
      <aside class="sidebar">
        <button id="shopBTN">🛒 포인트상점</button>
        <button id="communityBTN">💬 커뮤니티</button>
        <button>❓ 고객센터</button>
        <button id="gameBTN">🎮 게임</button>
        <button id="attendanceBTN">📅 출석체크</button>
      </aside>

      <!-- 메인 컨텐츠 -->
      <main class="main" id="MainContent">
        <!-- 검색 페이지 -->
        <section id="searchPage" class="page">
          <h2>올바른 분리수거 방법을 물어보세요.</h2>

          <!-- 대화창 + 입력창을 감싸는 래퍼 -->
          <div class="chat-wrapper">
            <!-- 대화가 쌓이는 부분 (초기엔 숨김) -->
            <div
              id="chatContainer"
              class="chat-container"
              style="display: none"
            ></div>

            <!-- 원래 검색창 (입력창) → 아래로 이동 -->
            <div class="search-box chat-input-box">
              <input
                type="text"
                placeholder="무엇이든 물어보세요"
                id="searchInput"
              />
              <button id="searchBtn">검색</button>
            </div>
            <!-- 기존 tip 영역 유지 -->
            <div class="tip">
              <span>👉</span> 음식물 묻은 스티로폼은 어디에 버릴까?
            </div>
          </div>
        </section>

        <!-- 포인트 상점 -->
        <section id="shopPage" class="page" style="display: none">
          <h2>포인트 상점</h2>
          <p>내 포인트: <span id="userPoint">1250</span>P</p>
          <div class="shop-grid">
            <div class="item-card" data-price="700" data-name="스타벅스 쿠폰">
              <img src="image/pointshop/coffee.png" alt="스타벅스 쿠폰" />
              <h3>스타벅스 쿠폰</h3>
              <p class="price">700P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="100" data-name="재활용 봉투">
              <img src="image/pointshop/recycle.png" alt="재활용 봉투" />
              <h3>재활용 봉투</h3>
              <p class="price">100P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="1000" data-name="에코백">
              <img src="image/pointshop/echobag.png" alt="에코백" />
              <h3>에코백</h3>
              <p class="price">1000P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="1200" data-name="텀블러">
              <img src="image/pointshop/tumbler.png" alt="텀블러" />
              <h3>텀블러</h3>
              <p class="price">1200P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="150" data-name="친환경 빨대">
              <img src="image/pointshop/echostraw.png" alt="친환경 빨대" />
              <h3>친환경 빨대</h3>
              <p class="price">150P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="120" data-name="친환경 수세미">
              <img src="image/pointshop/ecoscrubber.png" alt="친환경 수세미" />
              <h3>친환경 수세미</h3>
              <p class="price">120P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="300" data-name="대나무 칫솔">
              <img
                src="image/pointshop/bambootoothbrush.png"
                alt="대나무 칫솔"
              />
              <h3>대나무 칫솔</h3>
              <p class="price">300P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="1300" data-name="분리수거통">
              <img src="image/pointshop/recyclingbin.png" alt="분리수거통" />
              <h3>분리수거통</h3>
              <p class="price">1300P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="800" data-name="친환경 세제">
              <img src="image/pointshop/detergent.png" alt="친환경 세제" />
              <h3>친환경 세제</h3>
              <p class="price">800P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div
              class="item-card"
              data-price="2000"
              data-name="태양광 보조배터리"
            >
              <img
                src="image/pointshop/auxiliarybattery.png"
                alt="태양광 보조배터리"
              />
              <h3>태양광 보조배터리</h3>
              <p class="price">2000P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div
              class="item-card"
              data-price="600"
              data-name="친환경 폰 케이스"
            >
              <img src="image/pointshop/case.png" alt="친환경 폰 케이스" />
              <h3>친환경 폰 케이스</h3>
              <p class="price">600P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="500" data-name="천연 방향제">
              <img
                src="image/pointshop/natural air fresheners.png"
                alt="천연 방향제"
              />
              <h3>천연 방향제</h3>
              <p class="price">500P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div
              class="item-card"
              data-price="1000"
              data-name="업사이클링 키트"
            >
              <img src="image/pointshop/kit.png" alt="업사이클링 키트" />
              <h3>업사이클링 키트</h3>
              <p class="price">1000P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="200" data-name="업사이클링 키링">
              <img src="image/pointshop/keyring.png" alt="업사이클링 키링" />
              <h3>업사이클링 키링</h3>
              <p class="price">200P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="500" data-name="업사이클 가방">
              <img src="image/pointshop/bag.png" alt="업사이클 가방" />
              <h3>업사이클 가방</h3>
              <p class="price">500P</p>
              <button class="exchange-btn">교환하기</button>
            </div>

            <div class="item-card" data-price="800" data-name="업사이클 지갑">
              <img src="image/pointshop/wallet.png" alt="업사이클 지갑" />
              <h3>업사이클 지갑</h3>
              <p class="price">800P</p>
              <button class="exchange-btn">교환하기</button>
            </div>
          </div>
        </section>

        <!-- 커뮤니티 -->
        <section id="communityPage" class="page" style="display: none">
          <h2>💬 커뮤니티</h2>
          <div class="write-btn-box">
            <button id="writePostBtn">✏️ 글쓰기</button>
          </div>

          <div id="postList">
            <table class="community-table">
              <thead>
                <tr>
                  <th style="width: 60px">탭</th>
                  <th style="text-align: left">제목</th>
                  <th style="width: 120px">글쓴이</th>
                  <th style="width: 100px">날짜</th>
                  <th style="width: 80px">조회</th>
                  <th style="width: 60px">추천</th>
                </tr>
              </thead>
              <tbody id="postTableBody">
                <tr
                  class="notice-row"
                  style="background: #fffbe6; font-weight: bold"
                >
                  <td class="category notice">공지</td>
                  <td class="title">
                    <a href="#" class="post-link">📢 커뮤니티 이용 안내</a>
                  </td>
                  <td>관리자</td>
                  <td>2025-11-01 12:00</td>
                  <td>999</td>
                  <td>50</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div id="writeForm" style="display: none">
            <h3>게시판 - 글쓰기</h3>

            <!-- 제목 -->
            <div class="form-group">
              <label for="postTitle">* 제목</label>
              <input
                type="text"
                id="postTitle"
                placeholder="제목을 입력하세요"
              />
            </div>

            <!-- 내용 -->
            <div class="form-group">
              <label>* 내용</label>

              <!-- 툴바 -->
              <div class="editor-toolbar">
                <select id="fontSizeSelect">
                  <option value="12px">12px</option>
                  <option value="14px">14px</option>
                  <option value="16px" selected>16px</option>
                  <option value="18px">18px</option>
                  <option value="20px">20px</option>
                </select>

                <button type="button" onclick="format('bold')"><b>B</b></button>
                <button type="button" onclick="format('italic')">
                  <i>I</i>
                </button>
                <button type="button" onclick="format('underline')">
                  <u>U</u>
                </button>

                <button type="button" onclick="format('justifyLeft')">
                  좌
                </button>
                <button type="button" onclick="format('justifyCenter')">
                  중
                </button>
                <button type="button" onclick="format('justifyRight')">
                  우
                </button>

                <input type="color" id="fontColor" title="글자색" />
              </div>

              <div id="editor" contenteditable="true" class="editor"></div>
            </div>
            <!-- 첨부파일 -->
            <div class="form-group">
              <label for="postFile">첨부파일</label>
              <input type="file" id="postFile" />
            </div>

            <!-- 버튼 -->
            <div class="form-group buttons">
              <button id="savePost" class="save-btn">저장</button>
              <button id="cancelPost" class="cancel-btn">목록</button>
            </div>
          </div>
          <!-- 게시글 상세보기 (처음엔 숨김) -->
          <div
            id="postDetail"
            style="
              display: none;
              background: #fff;
              padding: 20px;
              border-radius: 10px;
            "
          >
            <h3 id="detailTitle"></h3>
            <div
              id="detailContent"
              style="
                margin-top: 10px;
                border-top: 1px solid #ddd;
                padding-top: 10px;
              "
            ></div>
            <button id="closeDetailBtn" style="margin-top: 15px">닫기</button>
          </div>
        </section>

        <!-- 게임 페이지 -->
        <section id="gamePage" class="page" style="display: none">
          <h2>게임</h2>
          <div class="game-grid">
            <div
              class="game-card"
              onclick="location.href='drag&drop_game.html'"
            >
              <h3>drag&drop_game</h3>
              <img
                src="image/game/drag&drop_game.png"
                style="width: 100%; height: auto"
              />
            </div>

            <div
              class="game-card"
              onclick="location.href='trash_catch_game.html'"
            >
              <h3>trash_catch_game</h3>
              <img
                src="image/game/trash_catch_game.png"
                style="width: 100%; height: auto"
              />
            </div>
          </div>
        </section>
        <!-- 출석 체크 페이지 -->
        <section id="attendancePage" class="page" style="display: none">
          <h2>📅 출석 체크</h2>

          <div class="attendance-wrapper">
            <!-- 출석 정보 텍스트 -->
            <p class="attendance-info">
              이번 달 출석일수: <span id="attendanceCount">0</span>일
            </p>

            <!-- 출석 보상 28칸 -->
            <div class="attendance-grid" id="attendanceGrid"></div>

            <button id="attendanceCheckBtn" class="attendance-btn">
              출석하기
            </button>
          </div>
        </section>
      </main>
    </div>

    <script src="script.js"></script>

    <!-- 로그인 상태에 따라 버튼 토글 스크립트 -->
    <script>
      (function () {
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const mypageBtn = document.getElementById('mypageBtn');
        const isLoggedIn = !!localStorage.getItem('userId');

        // 표시/숨김 전환
        if (isLoggedIn) {
          if (loginBtn) loginBtn.style.display = 'none';
          if (logoutBtn) logoutBtn.style.display = 'inline-block';
        } else {
          if (loginBtn) loginBtn.style.display = 'inline-block';
          if (logoutBtn) logoutBtn.style.display = 'none';
        }

        // 클릭 동작
        if (logoutBtn) {
          logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('userId');
            localStorage.removeItem('loginUser');
            localStorage.removeItem('nickname');
            alert('로그아웃되었습니다.');
            location.reload();
          });
        }

        if (mypageBtn) {
          mypageBtn.addEventListener('click', () => {
            if (!isLoggedIn) {
              alert('로그인이 필요합니다.');
              location.href = 'login.html';
            } else {
              location.href = 'mypage.html';
            }
          });
        }
      })();
    </script>
  </body>
</html>
